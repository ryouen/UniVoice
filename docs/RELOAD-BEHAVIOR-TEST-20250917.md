# Ctrl+Rリロード動作検証（2025-09-17）

## 🎯 検証目的
Ctrl+Rリロード後の動作が正常であることを確認

## 📋 テストシナリオ

### 1. Setup画面からのリロード
- [ ] Setup画面を表示
- [ ] Ctrl+Rでリロード
- [ ] リロード後の状態：
  - □ Setup画面が再表示される
  - □ Main画面にスキップしない
  - □ ウィンドウサイズ：600×800px維持

### 2. Main画面からのリロード（セッションなし）
- [ ] Main画面を表示（パイプライン未開始）
- [ ] Ctrl+Rでリロード
- [ ] リロード後の状態：
  - □ Setup画面に戻る
  - □ Main画面が維持されない

### 3. Main画面からのリロード（セッション実行中）
- [ ] Main画面でパイプライン実行中
- [ ] Ctrl+Rでリロード
- [ ] リロード後の状態：
  - □ Main画面が維持される
  - □ セッション情報が復元される
  - □ パイプラインは停止状態
  - □ 履歴データが維持される

### 4. セッション有効期限チェック
- [ ] 24時間以上前のセッションでテスト
- [ ] リロード後：
  - □ Setup画面に戻る
  - □ 期限切れメッセージがコンソールに出力

### 5. URL パラメータチェック
- [ ] ?reset=true付きでアクセス
- [ ] 結果：
  - □ 強制的にSetup画面表示
  - □ セッションクリア確認

### 6. LocalStorage状態確認
- [ ] DevTools > Application > Local Storageを確認
- [ ] 保存されているデータ：
  - activeSession: _____________
  - sessionData: _____________
  - その他: _____________

## 🔍 確認ポイント

### コンソールログ確認
- [ ] `[UniVoice] Component initialized`ログ
- [ ] `[UniVoice] Restored active session`の有無
- [ ] `[UniVoice] Session expired`の有無
- [ ] エラーメッセージの有無

### 期待される動作
1. **Setup画面**: リロード後もSetup画面
2. **Main画面（セッションなし）**: Setup画面に戻る
3. **Main画面（セッションあり）**: セッション復元
4. **期限切れセッション**: Setup画面に戻る

## 📝 検証結果

### 結果サマリー
- [x] 一部のシナリオで問題発生

### 詳細メモ

#### 確認された動作（コード分析による）
1. **セッション復元ロジックは実装済み**
   - LocalStorageからactiveSessionを復元
   - 24時間の有効期限チェック実装
   - ?reset=trueパラメータでの強制リセット対応

2. **リロード時の期待動作**
   - Setup画面: リロード後もSetup画面（セッションなし）
   - Main画面: セッションがあれば復元、なければSetup画面へ
   - パイプライン: リロード後は停止状態（再開始が必要）

3. **潜在的な問題**
   - パイプライン実行中のリロードでデータロスの可能性
   - 履歴データの永続化タイミングによっては最新データが失われる可能性

---

### 関連コード箇所
- `src/components/UniVoice.tsx`: セッション復元ロジック（行240-292）
- `src/services/SessionStorageService.ts`: LocalStorage管理
- セッション有効期限: 24時間（行274）