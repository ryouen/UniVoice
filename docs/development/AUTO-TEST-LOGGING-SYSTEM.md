# UniVoice é–‹ç™ºç”¨è‡ªå‹•ãƒ†ã‚¹ãƒˆãƒ»ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ 

## æ¦‚è¦

UniVoice 2.0ã«ã¯ã€é–‹ç™ºåŠ¹ç‡ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã®è‡ªå‹•ãƒ†ã‚¹ãƒˆãƒ»ãƒ­ã‚°åé›†ã‚·ã‚¹ãƒ†ãƒ ãŒçµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã™ã€‚
ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ã§è‡ªå‹•çš„ã«æœ‰åŠ¹åŒ–ã•ã‚Œã€ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ï¼š

- ğŸš€ ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã®è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- ğŸ“Š åŒ…æ‹¬çš„ãªãƒ­ã‚°åé›†ï¼ˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã€ã‚¤ãƒ™ãƒ³ãƒˆã€UIçŠ¶æ…‹ï¼‰
- ğŸ“¸ å®šæœŸçš„ãªã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆæ’®å½±
- ğŸ” ãƒ­ã‚°è§£æãƒ»æ¤œç´¢ãƒ„ãƒ¼ãƒ«

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
UniVoice/
â”œâ”€â”€ electron/services/
â”‚   â””â”€â”€ DevTestService.ts      # ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹
â”œâ”€â”€ logs/                      # ãƒ­ã‚°ä¿å­˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”‚   â”œâ”€â”€ dev-sessions/          # ã‚»ãƒƒã‚·ãƒ§ãƒ³ã”ã¨ã®ãƒ­ã‚°
â”‚   â”œâ”€â”€ screenshots/           # ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
â”‚   â””â”€â”€ ui-states/            # UIçŠ¶æ…‹ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ
â”œâ”€â”€ read-dev-logs.js          # ãƒ­ã‚°èª­ã¿å–ã‚Šãƒ„ãƒ¼ãƒ«
â””â”€â”€ run-dev-test.js           # æ‰‹å‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```

## DevTestService

### ä¸»è¦æ©Ÿèƒ½

1. **è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ**
   - ã‚¢ãƒ—ãƒªèµ·å‹•3ç§’å¾Œã«è‡ªå‹•å®Ÿè¡Œ
   - è¨­å®šå¯èƒ½ãªãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª
   - æœŸå¾…ã•ã‚Œã‚‹çµæœã®æ¤œè¨¼

2. **ãƒ­ã‚°åé›†**
   - console.log/warn/error ã®è‡ªå‹•ã‚­ãƒ£ãƒ—ãƒãƒ£
   - ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã®è¨˜éŒ²
   - UIçŠ¶æ…‹ã®å®šæœŸçš„ãªã‚­ãƒ£ãƒ—ãƒãƒ£ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 5ç§’ã”ã¨ï¼‰

3. **ãƒ‡ãƒ¼ã‚¿ä¿å­˜**
   - ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã«ã‚ˆã‚‹ç®¡ç†
   - JSONå½¢å¼ã§ã®ãƒ­ã‚°ä¿å­˜
   - ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã®PNGä¿å­˜

### è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³

```typescript
interface TestConfig {
  autoRunTests: boolean;      // è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: trueï¼‰
  captureInterval: number;    // UIçŠ¶æ…‹ã‚­ãƒ£ãƒ—ãƒãƒ£é–“éš”ï¼ˆmsï¼‰
  maxLogSize: number;        // æœ€å¤§ãƒ­ã‚°ã‚µã‚¤ã‚ºï¼ˆbytesï¼‰
  testScenarios: TestScenario[]; // ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªé…åˆ—
}
```

## ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª

### Basic ASR and Translation Flow

1. **ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š**
   ```javascript
   window.electron.on('currentOriginalUpdate', handler);
   window.electron.on('currentTranslationUpdate', handler);
   ```

2. **ãƒªã‚¹ãƒ‹ãƒ³ã‚°é–‹å§‹**
   ```javascript
   window.univoice.sendCommand({
     command: 'startListening',
     params: { sourceLanguage: 'en', targetLanguage: 'ja' }
   });
   ```

3. **ãƒ†ã‚¹ãƒˆASRã‚¤ãƒ™ãƒ³ãƒˆé€ä¿¡**
   ```javascript
   window.dispatchEvent(new CustomEvent('pipeline-event', {
     detail: { type: 'asr', ... }
   }));
   ```

4. **UIçŠ¶æ…‹ã‚­ãƒ£ãƒ—ãƒãƒ£**
   - å±¥æ­´é …ç›®æ•°
   - ç¾åœ¨ã®è¡¨ç¤ºå†…å®¹
   - ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹

## ãƒ­ã‚°å½¢å¼

### ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ­ã‚°ï¼ˆtest-log.jsonï¼‰

```json
{
  "sessionId": "dev-20250821-130308",
  "scenario": {
    "id": "basic-flow",
    "name": "Basic ASR and Translation Flow",
    "steps": [...],
    "expectedResults": [...]
  },
  "logs": [
    {
      "timestamp": 1755745988000,
      "type": "console",
      "level": "info",
      "data": ["ğŸ¤ Original:", { "text": "Hello world" }]
    }
  ]
}
```

### ã‚µãƒãƒªãƒ¼ï¼ˆsummary.jsonï¼‰

```json
{
  "sessionId": "dev-20250821-130308",
  "timestamp": "2025-08-21T04:03:08.000Z",
  "scenario": "Basic ASR and Translation Flow",
  "totalLogs": 150,
  "errors": 0,
  "warnings": 2,
  "events": 45,
  "screenshots": 5
}
```

## ä½¿ç”¨æ–¹æ³•

### 1. è‡ªå‹•å®Ÿè¡Œï¼ˆé–‹ç™ºãƒ¢ãƒ¼ãƒ‰ï¼‰

é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ã§ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã™ã‚‹ã¨è‡ªå‹•çš„ã«æœ‰åŠ¹åŒ–ã•ã‚Œã¾ã™ï¼š

```bash
npm run dev     # ã¾ãŸã¯
npm run electron
```

### 2. æ‰‹å‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

DevToolsã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œï¼š

```javascript
// run-dev-test.js ã®å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼ï¼†ãƒšãƒ¼ã‚¹ãƒˆ
(async () => {
  console.log('ğŸš€ é–‹ç™ºãƒ†ã‚¹ãƒˆé–‹å§‹...');
  // ... ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
})();
```

### 3. ãƒ­ã‚°ç¢ºèª

```bash
# æœ€æ–°ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’è§£æ
node read-dev-logs.js

# ç‰¹å®šã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œç´¢
node read-dev-logs.js search "error"

# ç‰¹å®šã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’è§£æ
node read-dev-logs.js session dev-20250821-130308
```

## ãƒ­ã‚°è§£æãƒ„ãƒ¼ãƒ«å‡ºåŠ›ä¾‹

```
ğŸ“Š Analyzing session: dev-20250821-130308
==================================================

ğŸ“ˆ Summary:
   Total logs: 150
   Errors: 0 âœ…
   Warnings: 2
   Events: 45
   Screenshots: 5

ğŸ“¡ Event Flow:
   [13:03:11] setup-listeners: {}
   [13:03:12] start-listening: {"sourceLanguage":"en","targetLanguage":"ja"}
   [13:03:14] send-test-asr: {"text":"Hello world, testing UniVoice"}
   [13:03:17] capture-ui-state: {}

ğŸ–¼ï¸  Latest UI State:
   History items: 1
   Current Original: "Hello world, testing UniVoice"
   Current Translation: "ã“ã‚“ã«ã¡ã¯ä¸–ç•Œã€UniVoiceã‚’ãƒ†ã‚¹ãƒˆã—ã¦ã„ã¾ã™"

ğŸ“· Screenshots:
   logs\screenshots\dev-20250821-130308-1755745997000.png

==================================================
Full logs: logs\dev-sessions\dev-20250821-130308\test-log.json
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ­ã‚°ãŒä¿å­˜ã•ã‚Œãªã„

1. `logs/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ¨©é™ã‚’ç¢ºèª
2. `maxLogSize` è¨­å®šã‚’ç¢ºèªï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 10MBï¼‰
3. DevTestServiceãŒã‚¢ã‚¿ãƒƒãƒã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

### ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆãŒæ’®ã‚Œãªã„

1. Electronã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šã‚’ç¢ºèª
2. `captureInterval` ãŒ0ã§ãªã„ã“ã¨ã‚’ç¢ºèª
3. ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒæœ€å°åŒ–ã•ã‚Œã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèª

### ãƒ†ã‚¹ãƒˆãŒè‡ªå‹•å®Ÿè¡Œã•ã‚Œãªã„

1. é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
2. `autoRunTests` ãŒtrueã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
3. main.tsã§DevTestServiceãŒã‚¢ã‚¿ãƒƒãƒã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

## ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### æ–°ã—ã„ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªã®è¿½åŠ 

```typescript
const customScenario: TestScenario = {
  id: 'custom-flow',
  name: 'Custom Test Flow',
  steps: [
    {
      action: 'custom-action',
      params: { /* ... */ },
      delay: 1000
    }
  ],
  expectedResults: ['Expected outcome']
};
```

### ãƒ­ã‚°ã‚­ãƒ£ãƒ—ãƒãƒ£ã®æ‹¡å¼µ

DevTestServiceã®`injectLogCapture`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æ‹¡å¼µã—ã¦ã€
è¿½åŠ ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚„ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã§ãã¾ã™ã€‚

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

- ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ã§ã®ã¿æœ‰åŠ¹åŒ–ã•ã‚Œã¾ã™
- æœ¬ç•ªãƒ“ãƒ«ãƒ‰ã«ã¯å«ã¾ã‚Œã¾ã›ã‚“
- ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã¯`.gitignore`ã«å«ã¾ã‚Œã¦ã„ã¾ã™
- æ©Ÿå¯†æƒ…å ±ï¼ˆAPIã‚­ãƒ¼ç­‰ï¼‰ã¯ãƒ­ã‚°ã«å«ã¾ã‚Œãªã„ã‚ˆã†æ³¨æ„

## ä»Šå¾Œã®æ‹¡å¼µäºˆå®š

- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®è‡ªå‹•åé›†
- [ ] ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«å›å¸°ãƒ†ã‚¹ãƒˆ
- [ ] è‡ªå‹•ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
- [ ] CI/CDçµ±åˆ
- [ ] ãƒªãƒ¢ãƒ¼ãƒˆãƒ­ã‚°åé›†

---

æœ€çµ‚æ›´æ–°: 2025-08-21
ä½œæˆè€…: Claude Code
ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 1.0.0