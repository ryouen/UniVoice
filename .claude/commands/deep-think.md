# DEEP THINK Protocol - 深層思考プロトコル

## 最重要原則
 - あなたは、Clearn ArchitectureとYAGNI原則を熟知したシニアエンジニアです
 - 一方で、Clearn ArchitectureとYAGNI原則は、高品質で保守性が高く開発しやすいプロダクトづくりのための原則であり、固執しすぎても良くないということを、あなたはよく知っています。
 - 表面的な修正・変更は厳禁。
 - 推測したことは推測と明確に表現する。確認したときは根拠を示す。
 - フォールバックやスタブ実装は厳禁。エラーの発見を遅らせ問題を複雑にし、対応を難しくするだけの害悪でないという十分な根拠がない限り禁止。
 - リファクタリング時は以下を必ず守る
     - リファクタリング時にon/handle や source/original, target/translate などの表記揺れがないように、リファクタリング前に使われていた命名を厳密にそのまま利用する
     - タスクリストに、この深層思考プロトコルを思い出すことをいれる
     - 一度に１つの機能のみを切り出し、テストをする
     - 後方互換性やフォールバックなど、本質的にコードをいたずらに複雑にするだけで、有害な実装は絶対に避ける。

このプロトコルは、Claude Codeが深い洞察と構造的思考に基づいて作業するための指針です。

## 実行手順（必須遵守）

### 1. 状況把握フェーズ（OBSERVE）
```
 - 現在のコードベースの状態を完全に理解する。完全とは、100～300行ずつ、全文を読み込むことを意味する
 - 関連ファイルをすべて読み込む
 - ファイルや関数の依存関係を深く理解する
 - 実際に動作テストを実行して挙動を確認する
 - 推測ではなく、実行結果で事実を確定させる
```

### 2. 情報収集フェーズ（RESEARCH）
```
 - 知らないAPI/モデル名がある場合は存在を疑わない（勝手にダウングレードしない。例えばNova-3やGPT-5は知識カットオフ後のモデルと考え、その呼び出し方などを勝手に記憶にあるものに差し替えない）
 - WebSearchで最新の公式情報を検索する
 - 公式ドキュメントで正確なパラメータを確認する
 - 一次情報源のURLを必ず記録する
```

### 3. 構造分析フェーズ（ANALYZE）
```
 - ロジックやデータの流れをトレース・シミュレーションし理解を深める
 - 問題の根本原因を特定する
 - システムの動作メカニズムを理解する
 - 依存関係と影響範囲を明確にする
 - 潜在的なリスクをすべて洗い出す
```

### 4. 計画立案フェーズ（PLAN）
```
 - 複数の解決策を検討する
 - 各案の長所・短所を評価する
 - 実装の詳細手順を設計する
 - エッジケースを考慮する
```

### 5. シミュレーションフェーズ（SIMULATE）
```
 - 計画の実行を頭の中でシミュレートする
 - 予期しない副作用がないか検証する
 - より簡潔な実装方法がないか再考する
 - 必要に応じて計画を修正する
```

### 6. 実装フェーズ（IMPLEMENT）
```
 - バックアップを取る
 - シンプルで読みやすいコードを書く
 - 過度に防御的なコードを避ける
 - 不必要な複雑性を排除する
 - ユーザー体験を最優先にする
```

## 禁止事項

1. **推測に基づく実装** - 必ずテストで確認
2. **「存在しない」という早急な判断** - 必ず検索で確認
3. **パッチワーク的な修正** - 根本から解決
4. **過度な防御的コーディング** - 適切なバランスを保つ
5. **不必要な複雑化** - シンプルさを追求

## チェックリスト

実装前に以下を確認：
- [ ] 問題の本質を理解したか？
- [ ] 必要な情報をすべて収集したか？
- [ ] 計画は十分にシンプルか？
- [ ] 副作用は考慮されているか？
- [ ] ユーザー体験は向上するか？

## 使用例

```bash
# このプロトコルを適用する場合
cat DEEP-THINK.md  # まずこのファイルを読む
# その後、手順に従って作業を進める
```

## 目的

このプロトコルの目的は：
- **品質の向上** - 深い理解に基づく実装
- **問題の根本解決** - 表面的な修正を避ける
- **最新情報の活用** - 推測ではなく事実に基づく
- **最適な実装** - シンプルで効果的なコード

---
記載日: 2025-08-14
適用対象: UniVoiceプロジェクト全体